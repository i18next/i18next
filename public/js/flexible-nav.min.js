/*!
 * Flexible Nav - 2011 - by @greweb
 */
(function(e){var b=0;var c=function(){return ++b};var a=function(f){var h=e('<nav class="flexible-nav"><ul></ul></nav>');var g=e.map(f,function(i){return e('<li><a href="'+i.href+'">'+i.text+"</a></li>")[0]});h.find("ul").append(g);return h};var d=function(g){var f=e(g).attr("href");if(f.substring(0,1)=="#"){var h=e(f);return h.size()?h:null}return null};window.FlexibleNavMaker=function(f){var g=this;g.nodes=e(f||"h1,h2,h3");g.make=function(){var h=g.nodes.map(function(){var i=e(this);var k=i.attr("id");if(!k){while(!k){k="n"+(c());if(e("#"+k).size()>0){k=null}}i.attr("id",k)}var j=i.attr("data-navtext")||i.text();return{href:"#"+k,text:j}});return a(h)}};window.FlexibleNav=function(g){var f=this;f.nav=e(g);f.updateClasses=function(){f.nav.find("a").each(function(){var h=e(this);var i=d(h);if(i){h.addClass("tnn-"+i[0].nodeName.toLowerCase())}})};f.update=function(){var k=e(document).height();var l=e(window).height();var h=f.nav.find("a").map(function(){var m=e(this);var n=d(m);if(n==null||!n.is(":visible")){return null}return{top:n.offset().top,node:m}});e.each(h,function(m,n){n.node.css("top",(100*n.top/k)+"%")});var j=e(document).scrollTop();var i=null;e.each(h,function(m,n){n.node.removeClass("current");if(i==null||(n.top<=j&&n.top>i.top)){i=n}});i&&i.node.addClass("current")};e(window).scroll(function(){f.update()});f.updateClasses();f.update()}}(jQuery));